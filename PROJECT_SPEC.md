# Signal Portal プロジェクト仕様書

## 📋 プロジェクト概要

Signal Portalは、個人向け（toC）と企業向け（toB）の2つの顧客タイプをサポートするWebアプリケーションです。

---

## 🔐 認証・登録フロー（共通）

### ① Login / 新規登録
- ユーザーはログインまたは新規登録を選択
- **ユーザータイプの選択**: 個人（toC） / 企業（toB）を選択
- 認証完了後、ユーザータイプに応じて異なるフローへ遷移

---

## 👤 個人向け（toC）フロー

### ② プラン選択
- 複数のプランから選択
- プランの詳細（料金、機能、期間など）を表示

### ③ クレジットカード決済（toCのみ）
- 外部決済APIを使用（**Stripe** - JPY対応）
- 決済フォームの実装
- 決済処理の完了待ち
- **注意**: toBは別の請求方法を使用（後述）

### ④ Homeページへの遷移
- 決済完了後、Homeページにリダイレクト
- **初回以降の挙動**: 決済が月1回の場合、決済日までは①→④のフローを経由
- 決済通知はHomeページ内で表示（実装方法は要検討）

---

## 🏠 toC Homeページ機能

### メインコンテンツ
- **概要説明動画**: サービスの紹介動画

### サイドバーメニュー
1. **使い方動画**: 操作手順の動画コンテンツ
2. **サポート**: お問い合わせ・ヘルプページ
3. **アカウント管理**: 別URLアプリに遷移
4. **契約内容確認**: 現在の契約プラン、期間、決済情報など

### フローティングQ&A
- **画面右下に常時表示**: 丸いチャットアイコンボタン
- **チャット風UI**: クリックで展開、Q&Aを検索・表示
- **Firestore連携**: Q&AデータをFirestoreで管理

---

## 🏢 企業向け（toB）機能

### Homeページ機能

#### メイン機能
- **運営からのお知らせ**: 重要な通知・更新情報
- **稼働アカウント一覧**: 別URLアプリのアカウント情報を表示
  - アカウント付与機能
  - コース情報
  - KPI達成率
  - 契約日などの詳細情報

#### サイドバーメニュー
1. **使い方動画**: 操作手順の動画コンテンツ
2. **営業資料**: 資料の保存・閲覧機能（ダウンロード以外の保存方法も可）
3. **サポート**: お問い合わせ・ヘルプページ
4. **成功事例・失敗事例の共有ページ**: ケーススタディの閲覧
5. **請求書関係**: 契約内容確認、請求書の表示・ダウンロード

---

## 💳 決済・請求システム

### toC（個人顧客）: Stripe決済
- **使用API**: **Stripe** - JPY対応
- **特徴**:
  - 国際的な標準的な決済API
  - 豊富なドキュメント
  - React/Next.jsとの統合が容易
  - サブスクリプション（月次決済）のサポート
  - セキュリティ対策が充実
- **公式サイト**: https://stripe.com/jp
- **実装**: プラン選択後、Stripe CheckoutまたはStripe Elementsで決済処理

### toB（企業顧客）: 別請求システム
- **方法**: toBはStripe決済を使用せず、別の請求方法を採用
- **想定される方法**:
  1. **請求書ベース**: 手動または自動で請求書を生成・送付
  2. **銀行振込**: 請求書発行後、銀行振込で支払い
  3. **Stripe Invoicing**: Stripeの請求書機能を使用（Stripe決済ではない）
  4. **外部請求システム**: 既存の請求管理システムとの連携
  5. **月次請求**: 契約に基づき月次で請求書を自動発行
- **実装方針**: toBユーザーは決済フローを経由せず、登録後すぐにHomeページへアクセス可能
- **請求書管理**: Homeページの「請求書関係」メニューで請求書の確認・ダウンロードが可能

**柔軟な対応が可能**: toCとtoBで異なる決済・請求方法を採用することで、それぞれのニーズに最適化した仕組みを構築できます。

---

## 🔄 ユーザーフロー図

### toC（個人）ユーザー
```
Login/新規登録 → プラン選択 → クレジットカード決済 → Homeページ
                      ↑                                    ↓
                      └──────── 月次決済通知 ←─────────────┘
```

### toB（企業）ユーザー
```
Login/新規登録 → Homeページ（企業向けダッシュボード）
```

---

## 🛠 技術スタック

- **フロントエンド**: Next.js 16.1.1, React 19.2.3, TypeScript 5
- **スタイリング**: Tailwind CSS v4
- **バックエンド**: Firebase (Firestore, Auth, Storage)
- **ホスティング**: Vercel
- **決済**: Stripe（toCのみ、JPY対応）
- **請求**: toBは別システム（要検討）

---

## 📝 実装優先順位（要検討事項）

### フェーズ1: 基盤
- [ ] 認証システム（Firebase Auth）
- [ ] ユーザータイプ（toC/toB）の判定
- [ ] ルーティング設計

### フェーズ2: toC機能
- [ ] プラン選択画面
- [ ] Stripe決済統合
- [ ] toC Homeページ
- [ ] サイドバーメニュー実装

### フェーズ3: toB機能
- [ ] toB Homeページ（ダッシュボード）
- [ ] アカウント管理機能
- [ ] お知らせ機能

### フェーズ4: その他機能
- [ ] 動画コンテンツ統合
- [ ] Q&Aフローティングボタン（右下常時表示）
- [ ] サポートページ
- [ ] 請求書・契約管理

---

## ❓ 要検討事項

1. **月次決済の通知方法**: toCのHomeページ内での通知UIデザイン
2. **決済日までの挙動**: toCの①→④のフロー詳細
3. **toB請求方法の詳細**: 請求書発行方法、支払い方法、自動化レベル
4. **別URLアプリとの連携**: アカウント管理アプリとの連携方法
5. **Q&Aの管理方法**: FirestoreでのQ&Aデータ管理、検索機能の詳細
6. **営業資料の保存方法**: ダウンロード以外の保存方式
7. **toB請求書の自動化**: 請求書の自動生成・送付システムの選定

---

## 📌 備考

- プロジェクト初期セットアップ完了済み
- Firebase環境変数設定済み
- Vercelデプロイ準備完了
- **toC決済**: Stripe（JPY完全対応、サブスクリプション対応）
- **toB請求**: 別システム採用（Stripe決済は使用しない）

